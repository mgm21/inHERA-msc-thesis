Bootstrap: library
From: airl_lab/default/airl_env:qdax_f57720d0

%labels
   Author m.faldor22@imperial.ac.uk

%post
   # Update
   apt-get update -y
   pip install --upgrade pip

   # Install
   pip install --upgrade typing-extensions==4.1.1
   pip install --upgrade chex
   pip install --upgrade absl-py
   pip install git+https://github.com/adaptive-intelligent-robotics/QDax.git@develop

   # Change this line if you get JAX or NVIDIA compatibility issue      
   pip install -U jax[cuda11_cudnn82] -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html  

   pip install -U "brax==0.1.2"

   # Create working directory
   mkdir -p /git/exp/inhera-msc-thesis

   #==================================================================================
   exit 0 #NOTFORFINAL - the lines below this "exit" will be executed only when building the final image
   #==================================================================================

   # Enter working directory
   cd /git/exp

   #CLONEHERE

   mkdir -p /git/exp/inhera-msc-thesis/results/

%runscript
   # The following line is to understand why this runscript does not work
   echo $PWD
   
   # Enter project
   # Check that this is not actually ../../git/exp/inhera-msc-thesis because HPC job failed 
   cd ../../../git/exp/inhera-msc-thesis/

   # The following line is to understand why this runscript does not work
   echo $PWD

   # Run main
   python mapelites-example-main.py

%help
   MAP-Elites example using QDax.
