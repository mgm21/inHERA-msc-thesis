Bootstrap: library
From: airl_lab/default/airl_env:qdax_f57720d0

%labels
   Author m.faldor22@imperial.ac.uk

%post
   # Update
   apt-get update -y
   pip install --upgrade pip

   # Install
   pip install --upgrade typing-extensions==4.1.1
   pip install --upgrade chex
   pip install --upgrade absl-py
   pip install git+https://github.com/adaptive-intelligent-robotics/QDax.git@develop

   # Change this line if you get JAX or NVIDIA compatibility issue      
   pip install -U jax[cuda11_cudnn82] -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html  

   pip install -U "brax==0.1.2"

   # Create working directory
   mkdir -p /git/exp/inhera-msc-thesis/

   #==================================================================================
   exit 0 #NOTFORFINAL - the lines below this "exit" will be executed only when building the final image
   #==================================================================================

   # Enter working directory
   echo $PWD
   ls -l
   cd /git/exp
   #CLONEHERE
   echo $PWD
   ls -l
   mkdir /git/exp/inhera-msc-thesis/results/
   mkdir /git/exp/results/


%runscript
   CURPATH=$(pwd)
   echo pwd is $(pwd)

   if [ ! -d ./results ]; then
      mkdir results
   fi

   # PATHNAME=$(date +%Y-%m-%d_%H_%M_%S)_$$
   # mkdir $CURPATH/results/$PATHNAME

   # Enter project
   cd /git/exp/inhera-msc-thesis

   # Run main
   python -m src.core.repertoire_optimiser --save_dir $CURPATH/results

%help
   MAP-Elites example using QDax.
